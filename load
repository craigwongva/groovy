drop table sentences;
create table sentences (
 id bigint auto_increment,
 s varchar(200));

insert into sentences(s) values('Siempre hay una manera positiva de ver las cosas, buscala');
insert into sentences(s) values('Domingo para reflexionar en las bendiciones que se te han dado');
insert into sentences(s) values('No puedo parar de mirarlo');
insert into sentences(s) values('Ahora conversan y opinan si les gustan mas los amores inocentes or con experiencia');
insert into sentences(s) values('Si quieres cenar algo ligera. Intenta esta Ensalada Griega');
insert into sentences(s) values('Este comercial te hara querer abrazar a tu perrito', 
insert into sentences(s) values('Felizmente me quedo con esta vista, con esta paz y tranquilidad que solo ofrece Castel Gandolfo');
insert into sentences(s) values('En tu closet no puede faltar un vestido negro');
insert into sentences(s) values('No deseches tus frascos');
insert into sentences(s) values('Mira como decorarlos para que sirvan de adornos en tu hogar');
insert into sentences(s) values('Aprende a decorar tus frascos ahora y reutilizalos');
insert into sentences(s) values('Tu pareja gasta mas dinero que tu?');
insert into sentences(s) values('Aprende como evitar problemas');

insert into sentences(s) values('Este miercoles te damos los trucos para lucir bien elegante en shorts');
insert into sentences(s) values('Manana voy a estar contestando sus preguntas sobre moda y estilo, a tiempo para el verano');
insert into sentences(s) values('Envien sus preguntas usando #AskThalia');

insert into sentences(s) values('Hoy es su cumpleanos');
insert into sentences(s) values('Hoy cumpleanos la periodista hondurena y copresentadora de @despiertamerica');
insert into sentences(s) values('Todos abrazaron a @satchapretto en un dia muy especial');

insert into sentences(s) values('Si te preguntabas que es #PanamaPapers, aqui te compartimos un resumen');
insert into sentences(s) values('Gracias por ver @despiertamerica hoy Lunes');
insert into sentences(s) values('Recuerden que pueden ver el show si te lo perdiste en la aplicacion #UnivisionNow');

insert into sentences(s) values('Feliz inicio de semana');
insert into sentences(s) values('Conoce ahora a la hija de @CristianCastro');
insert into sentences(s) values('Tiene dos anitos y es una estrella de las redes sociales');

insert into sentences(s) values('Si quieres que tus hijos tengan una vida adulta emocional saludable');
insert into sentences(s) values('Mira que puedes hacer');
insert into sentences(s) values('Enterate como hacer que la cama de tu mascota sea parte integral del diseno de casa');

insert into sentences(s) values('Que felicidad regresar a mi universidad');
insert into sentences(s) values('Por que Playboy esta apunto de morir');
insert into sentences(s) values('Nosotros tambien felices de tenerte con nosotros');

insert into sentences(s) values('Es viernes y mi cuerpo lo sabe');
insert into sentences(s) values('Alguna vez has espiado a tu pareja');
insert into sentences(s) values('Manana la @dranancyalvarez te dice como acabar con esta mania');
drop table labels;
create table labels (
 id bigint auto_increment,
 sid bigint,
 l varchar(60)
);

delete from labels where l = 'has-root-poder';
insert into labels (sid, l)
select id, 'has-root-poder'
from sentences s
where s.s regexp 'poder'
or s.s regexp 'puedo'
or s.s regexp 'puedes'
or s.s regexp 'puede'
or s.s regexp 'podemos'
or s.s regexp 'pueden'

delete from labels where l = 'has-root-decorar';
insert into labels (sid, l)
select id, 'has-root-decorar'
from sentences s
where s.s regexp 'decorar'
or s.s regexp 'decoro'
or s.s regexp 'decoras'
or s.s regexp 'decora'
or s.s regexp 'decoramos'
or s.s regexp 'decoran'

delete from labels where l = 'has-root-frasco';
insert into labels (sid, l)
select id, 'has-root-frasco'
from sentences s
where s.s regexp 'frasco'

delete from labels where l = 'has-word-cumpleanos';
insert into labels (sid, l)
select id, 'has-word-cumpleanos'
from sentences s
where s.s regexp 'cumpleanos'


--Find sentences with a certain label
select s.*
from sentences s
join labels l
on s.id = l.sid
where l = 'has-root-poder'

--Find labels in a certain sentence
select l.l
from labels l
where sid = 3

--Find sentences matching a certain sentence
select s.*, l.*
from sentences s
join labels l
on s.id = l.sid
where s.id <> 3
and l in (
select l.l
from labels l
where sid = 3
)

--Find sentences matching a certain sentence and user's input
select s.*, l.*
from sentences s
join labels l
on s.id = l.sid
where s.id <> 3
and s.s regexp 'faltar'
and l in (
select l.l
from labels l
where sid = 3
)

--Return one row. Not an optimized query!
select * from (
select rownum r, s.*, l.id lid, l.sid, l.l
from sentences s
join labels l
on s.id = l.sid
where s.id <> 3
--and s.s regexp 'faltar'
and l in (
select l.l
from labels l
where sid = 3
)
)
order by rand()
limit 1
--s.id=7 'No deseches tus frascos'
--s.id=9 Aprende a decorar tus frascos ahora y reutilizalos
--8 Mira como decorarlos para que sirvan de adornos en tu hogar

